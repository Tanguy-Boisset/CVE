# CVE-2023-52059

## Summary

| ID                    | CVE-2023-52059                                           |
|-----------------------|----------------------------------------------------------|
| **Type**              | XSS                                                      |
| **Title**             | Stored XSS in ticket's description and resolution fields |
| **Product impacted**  | Gestsup                                                  |
| **Impacted version**  | < 3.2.46                                                 |
| **CVSS Score**        | 5.4                                                      |
| **Author**            | Sopalinge                                                |

## Description

A lack of user input back-end sanitization allows remote attackers to perform a stored Cross-Site Scripting (XSS) attack in Gestsup < 3.2.46.

When creating or editing a ticket, an unprivileged user is able to intercept and edit the `Description` and `Resolution` fields directly in the request to bypass front-end sanitization and store malicious HTML content.


## Impact

An unprivileged user is then able to execute script on any user's browser who are viewing the malicious ticket.

The session cookie has the HttpOnly attribute, which protects it from client-side extraction.

However, combined with [CVE-2023-52060](../CVE-2023-52060/README.md), it can be used to take over privileged accounts directly from the Gestsup application.


## Timeline

- 24/12/2023 : Vulnerability discovered
- 24/12/2023 : Vendor contacted
- 25/12/2023 : Official fix published
- 25/01/2024 : CVE ID attributed
- ??/01/2024 : CVE publicly disclosed


## References

- [Gestsup website](https://gestsup.fr/index.php?page=home)
- [Fixing patch](https://gestsup.fr/index.php?page=download&channel=beta&version=3.2.46&type=patch)